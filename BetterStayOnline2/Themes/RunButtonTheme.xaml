<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:gif="http://wpfanimatedgif.codeplex.com">
    <Style BasedOn="{StaticResource {x:Type Button}}"
       TargetType="{x:Type Button}"
       x:Key="RunButtonTheme">
        <Style.Setters>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Border"
                            BorderBrush="{TemplateBinding BorderBrush}"
                            BorderThickness="{TemplateBinding BorderThickness}"
                            Background="{TemplateBinding Background}">
                            <Grid VerticalAlignment="Center"
                              HorizontalAlignment="Center">
                                <Image x:Name="LoadingImage" gif:ImageBehavior.AnimatedSource="../Images/spinner2.gif" Height="38" Width="38" Visibility="Collapsed" Opacity="0.5" HorizontalAlignment="Center"/>
                                <TextBlock x:Name="ButtonTextBlock" Text="Run" Visibility="Visible" HorizontalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#23272a"/>
                                <Setter Property="BorderBrush" Value="#1fad35"/>
                            </Trigger>
                            <DataTrigger Binding="{Binding testRunning}" Value="True">
                                <Setter TargetName="LoadingImage" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="ButtonTextBlock" Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding testRunning}" Value="False">
                                <Setter TargetName="LoadingImage" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="ButtonTextBlock" Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="4,0,0,0"/>
        </Style.Setters>
        <Style.Triggers>
            <DataTrigger Binding="{Binding testRunning}" Value="True">
                <Setter Property="Background" Value="#23272a"/>
                <Setter Property="BorderBrush" Value="#b8181d"/>
                <Setter Property="IsEnabled" Value="False"/>
            </DataTrigger>
            <DataTrigger Binding="{Binding testRunning}" Value="False">
                <Setter Property="IsEnabled" Value="True"/>
            </DataTrigger>
        </Style.Triggers>
    </Style>
</ResourceDictionary>